<html><body bgcolor="#333333" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><p>Limak is a grizzly bear.
He is currently making plans to attack Deerland.</p>
<br></br>
<p>Deerland has <b>N</b> cities, numbered from 0 to <b>N</b>-1.
The cities are all connected together by a network of roads.
There are exactly <b>N</b>-1 bidirectional roads, each connecting two cities.
(Hence, the topology of Deerland is a tree.)</p>
<br></br>
<p>Limak will attack each city in Deerland exactly once.
For each i, when he attacks city i, there are two possible outcomes:
<ul>
<li>With probability 1/(i+1) the city will defend itself successfully.</li>
<li>In all other cases the city is destroyed by Limak. The city disappears from Deerland, along with all roads that led into the city.</li>
</ul></p>
<br></br>
<p>Let's define a region as a connected component of Deerland.
In other words, a region is a maximal group of cities such that the existing roads allow us to travel between any two cities in the group.
Initially, the entire Deerland is a single region.
After Limak's <b>N</b> attacks Deerland will be divided into one or more regions.</p>
<br></br>
<p>The strength of a region is the square of the number of cities it contains.</p>
<br></br>
<p>You are given a description of Deerland in a format that is specified below.
Let E be the expected value of the sum of strengths of all regions after Limak attacks Deerland.
It can be proved that E*<b>N</b>! is an integer.
Return this integer modulo 1,000,000,007.</p>
<br></br>
<p>The description of Deerland is provided in the form of a pseudorandom generator.
You are given the ints <b>N</b>, <b>R0</b>, <b>A</b>, <b>B</b>, <b>M</b>, <b>LOW</b>, and <b>HIGH</b>.
As defined above, <b>N</b> is the number of cities in Deerland.
The list of roads is generated by the pseudocode below.</p>
<br></br>
<pre>
R = R0;
BILLION = 1000000000;
for i between 1 and N-1, inclusive:
    R = (A * R + B) modulo M;
    MIN = ((i-1) * LOW)  / BILLION;
    MAX = ((i-1) * HIGH) / BILLION;
    there is a road between city i and city MIN + (R modulo (MAX-MIN+1));
</pre>
<br></br>
<p>Both divisions in the pseudocode are integer divisions.
(Integer division rounds down. For example, 29/10 is 2.)
You may assume that the pseudocode always generates a valid tree.
Watch out for integer overflow when implementing it.</p></td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>BearAttacks</td></tr><tr><td>Method:</td><td>expectedValue</td></tr><tr><td>Parameters:</td><td>int, int, int, int, int, int, int</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int expectedValue(int N, int R0, int A, int B, int M, int LOW, int HIGH)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>2.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr><tr><td>Stack limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>N</b> will be between 1 and 1,000,000, inclusive.<br></br></td></tr><tr><td align="center" valign="top">-</td><td><b>M</b> will be between 1 and 1,000,000,000, inclusive.<br></br></td></tr><tr><td align="center" valign="top">-</td><td><b>R0</b>, <b>A</b> and <b>B</b> will be between 0 and <b>M</b>-1, inclusive.<br></br></td></tr><tr><td align="center" valign="top">-</td><td><b>LOW</b> and <b>HIGH</b> will be between 0 and 1,000,000,000, inclusive.<br></br></td></tr><tr><td align="center" valign="top">-</td><td><b>LOW</b> will not be greater than <b>HIGH</b>.<br></br></td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>3</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>2</pre></td></tr><tr><td><pre>3</pre></td></tr><tr><td><pre>100</pre></td></tr><tr><td><pre>938593850</pre></td></tr><tr><td><pre>1000000000</pre></td></tr></table></td></tr><tr><td><pre>Returns: 21</pre></td></tr><tr><td><table><tr><td colspan="2">There are <b>N</b>=3 cities.
The generator outputs that the two roads are 1-0 and 2-1.
Hence, Deerland is the path 0-1-2.
Here is what may happen:
<ul>
<li>With probability (1/1) * (1/2) * (1/3) = 1/6 all three cities survive. In this case we have a single region with strength 9.</li>
<li>With probability (1/1) * (1/2) * (2/3) = 2/6 only cities 0 and 1 survive. We have one region with strength 4.</li>
<li>With probability (1/1) * (1/2) * (1/3) = 1/6 only cities 0 and 2 survive. Here we have two regions, each with strength 1, hence the total strength is 2.</li>
<li>With probability (1/1) * (1/2) * (2/3) = 2/6 only city 0 survives. There is only one region and its strength is 1.</li>
</ul>
Therefore, the expected sum of regions' strengths is (1/6)*9 + (2/6)*4 + (1/6)*2 + (2/6)*1 = 21/6.
The correct return value is ( (21/6) * <b>N</b>! ) modulo 1,000,000,007, which is 21.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>3</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>0</pre></td></tr></table></td></tr><tr><td><pre>Returns: 23</pre></td></tr><tr><td><table><tr><td colspan="2">Again there are three cities, but now the roads are 1-0 and 2-0.
A different set of roads leads to a different answer.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>6</pre></td></tr><tr><td><pre>303840291</pre></td></tr><tr><td><pre>848660283</pre></td></tr><tr><td><pre>395739574</pre></td></tr><tr><td><pre>950123456</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>1000000000</pre></td></tr></table></td></tr><tr><td><pre>Returns: 3856</pre></td></tr><tr><td><table><tr><td colspan="2">Six cities. Roads: 1-0, 2-1, 3-1, 4-3, 5-1.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>1</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>1</pre></td></tr><tr><td><pre>0</pre></td></tr><tr><td><pre>0</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>19</pre></td></tr><tr><td><pre>384038999</pre></td></tr><tr><td><pre>938592393</pre></td></tr><tr><td><pre>692854433</pre></td></tr><tr><td><pre>1000000000</pre></td></tr><tr><td><pre>300000000</pre></td></tr><tr><td><pre>600000000</pre></td></tr></table></td></tr><tr><td><pre>Returns: 473263988</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
