<html><body bgcolor="#333333" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><i>This problem has a non-standard time limit: 5 seconds.</i>

<p>
Alice and Bob play a game using an undirected weighted graph.
The graph has no self-loops and no multiple edges.
The graph has <b>n</b> nodes.
The nodes are numbered 0 through <b>n</b>-1.
</p>

<p>
You are given the int <b>n</b>.
You are also given three vector &lt;int&gt;s: <b>a</b>, <b>b</b>, and <b>c</b>, each with the same number of elements.
For each valid i, there is an edge that connects nodes <b>a</b>[i] and <b>b</b>[i], and the weight of this edge is <b>c</b>[i].
</p>

<p>
In the first step of the game Alice chooses a nonempty subset of the nodes of the graph and paints them red.
This subset must form a clique in the graph.
(I.e., each pair of nodes selected by Alice must be connected by an edge.
Specifically, Alice is allowed to select any single node.
Alice is also allowed to select all nodes, if the entire graph is a clique.)
</p>

<p>
Next, Bob colors all the remaining nodes blue.
These nodes are not required to form a clique.
</p>

<p>
Alice's score is the sum of weights of all edges that have both endpoints red.
Similarly, Bob's score is the sum of weights of all edges that have both endpoints blue.
The result of the game is computed as Alice's score minus Bob's score.
Note that the result of the game may be negative.
</p>

<p>
Given the graph, consider all valid sets of vertices Alice can choose.
For each of those sets we can compute the result of the game.
Let S be the sum of all those results.
Compute and return the value (S modulo 1,000,000,007).
</p></td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>CliqueCuts</td></tr><tr><td>Method:</td><td>sum</td></tr><tr><td>Parameters:</td><td>int, vector &lt;int&gt;, vector &lt;int&gt;, vector &lt;int&gt;</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int sum(int n, vector &lt;int&gt; a, vector &lt;int&gt; b, vector &lt;int&gt; c)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>5.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr><tr><td>Stack limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>n</b> will be between 2 and 45, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>m will be between 0 and <b>n</b>*(<b>n</b>-1)/2, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>a,b,c</b> will each have exactly m elements each.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>a,b</b> will be between 0 and <b>n</b>-1, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>Each element of <b>c</b> will be between 0 and 10^9, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td>The edges (<b>a</b>[i], <b>b</b>[i]) form a simple undirected graph with no self-loops or multiple edges.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>2</pre></td></tr><tr><td><pre>{0}</pre></td></tr><tr><td><pre>{1}</pre></td></tr><tr><td><pre>{100}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 100</pre></td></tr><tr><td><table><tr><td colspan="2">The graph has 2 nodes and a single edge: the edge 0-1 with weight 100.
Alice has three valid choices: she can choose either {0}, or {1}, or {0,1}.
<ul>
<li>In the first case: Alice's score is 0, Bob's score is 0, hence the result of the game is 0-0 = 0.</li>
<li>In the second case: Alice's score is 0, Bob's score is 0, hence the result of the game is 0-0 = 0.</li>
<li>In the third case: Alice's score is 100, Bob's score is 0, hence the result of the game is 100-0 = 100.</li>
</ul>
The sum of all possible results is S = 0 + 0 + 100 = 100.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>5</pre></td></tr><tr><td><pre>{0,0,0,0,1,1,1,2,2,3}</pre></td></tr><tr><td><pre>{1,2,3,4,2,3,4,3,4,4}</pre></td></tr><tr><td><pre>{0,1,2,3,4,5,6,7,8,9}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 45</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>5</pre></td></tr><tr><td><pre>{0,1,2,3}</pre></td></tr><tr><td><pre>{1,2,3,4}</pre></td></tr><tr><td><pre>{9,2,4,3}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 999999941</pre></td></tr><tr><td><table><tr><td colspan="2">This graph is the line 0-1-2-3-4.
The edge weights are 9, 2, 4, and 3, respectively.

As there is no triangle in this graph, Alice can only choose either a single vertex or two adjacent vertices.
Thus, she has the following options: {0}, {1}, {2}, {3}, {4}, {0,1}, {1,2}, {2,3}, and {3,4}.
Alice's scores in these cases are 0, 0, 0, 0, 0, 9, 2, 4, and 3.
Bob's corresponding scores are 9, 7, 12, 11, 15, 7, 3, 9, and 11.

Thus, there are nine possible results of the game: -9, -7, -12, -11, -15, 2, -1, -5, and -8, which gives us S = -66.
As we are supposed to return S modulo 1,000,000,007, the correct return value is 999,999,941.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>10</pre></td></tr><tr><td><pre>{0,1,2,9,5,3,4,7,3,4,1,5,2,3,0,7,8}</pre></td></tr><tr><td><pre>{6,7,4,5,6,2,6,3,1,8,2,0,9,9,8,2,5}</pre></td></tr><tr><td><pre>{10000,10000000,100000000,100,10,1,1000,100,10000,100,10000,1000,100,10,100,100000000,10}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 209370454</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>45</pre></td></tr><tr><td><pre>{}</pre></td></tr><tr><td><pre>{}</pre></td></tr><tr><td><pre>{}</pre></td></tr></table></td></tr><tr><td><pre>Returns: 0</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
