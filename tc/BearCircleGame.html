<html><body bgcolor="#333333" text="#ffffff"><table><tr><td colspan="2"><h3>Problem Statement</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><p><b>N</b> bears are standing around a circle and playing a game.
Before the game started, the bears have chosen a positive integer <b>K</b>.</p>
<br></br>
<p>The game is played as follows:
Limak, who is one of the <b>N</b> bears, will start the game by saying the number 1.
The game then goes clockwise around the circle: the next bear clockwise from Limak will say 2, his other neighbor will say 3, and so on.</p>
<br></br>
<p>The bear who says the chosen number <b>K</b> must toss a fair coin and call heads or tails.
If he loses the coin flip, he loses and he is removed from the game.
If he wins the flip, he remains in the game.
Regardless of the outcome of the coin flip, the game continues with the next bear in clockwise order.
That bear will now start counting from 1 again.</p>
<br></br>
<p>The last bear who remains in the game is the winner.
Can you find the probability that Limak will win?</p>
<br></br>
<p>You are given the ints <b>N</b> and <b>K</b>.
Find the probability that Limak wins the game.
Express that probability as a fraction X/Y in reduced form.
(I.e., X and Y should be relatively prime.)
Let M = 1,000,000,007.
For the given constraints it can be shown that Y will never be divisible by M.
Thus, it has an inverse element modulo M: an integer Z between 1 and M-1, inclusive, such that (Y*Z) modulo M is 1.
Return the value (X*Z) modulo M.</p></td></tr><tr><td colspan="2"><h3>Definition</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Class:</td><td>BearCircleGame</td></tr><tr><td>Method:</td><td>winProbability</td></tr><tr><td>Parameters:</td><td>int, int</td></tr><tr><td>Returns:</td><td>int</td></tr><tr><td>Method signature:</td><td>int winProbability(int n, int k)</td></tr><tr><td colspan="2">(be sure your method is public)</td></tr></table></td></tr><tr><td colspan="2"><h3>Limits</h3></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td>Time limit (s):</td><td>4.000</td></tr><tr><td>Memory limit (MB):</td><td>256</td></tr><tr><td>Stack limit (MB):</td><td>256</td></tr></table></td></tr><tr><td colspan="2"><h3>Notes</h3></td></tr><tr><td align="center" valign="top">-</td><td>Note the unusual Time Limit.</td></tr><tr><td colspan="2"><h3>Constraints</h3></td></tr><tr><td align="center" valign="top">-</td><td><b>N</b> will be between 2 and 2000, inclusive.</td></tr><tr><td align="center" valign="top">-</td><td><b>K</b> will be between 1 and 1,000,000,000, inclusive.</td></tr><tr><td colspan="2"><h3>Examples</h3></td></tr><tr><td align="center" nowrap="true">0)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>2</pre></td></tr><tr><td><pre>1</pre></td></tr></table></td></tr><tr><td><pre>Returns: 333333336</pre></td></tr><tr><td><table><tr><td colspan="2">As <b>K</b>=1, as the game goes around the circle, each bear says "1" and then flips a coin to see whether they lose.
With <b>N</b>=2 bears we can count as follows:
<ul>
<li>With probability 1/2, Limak loses the game in the first coin flip.</li>
<li>With probability 1/4, Limak wins his flip and then his opponent loses.</li>
<li>With probability 1/8, Limak and his opponent both win their first flip, and then Limak loses his second flip.</li>
<li>... and so on.</li>
</ul>
Thus, the total probability that Limak wins the game is 1/4 + 1/16 + 1/64 + 1/256 + ... = 1/3.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">1)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>2</pre></td></tr><tr><td><pre>2</pre></td></tr></table></td></tr><tr><td><pre>Returns: 1</pre></td></tr><tr><td><table><tr><td colspan="2">Limak will say 1.
His opponent will say 2 and flip a coin.
If the opponent loses the flip, Limak wins the game.
Otherwise, the same process is repeated once again.
Limak cannot lose this game.
He will win it with probability 1.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">2)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>3</pre></td></tr><tr><td><pre>2</pre></td></tr></table></td></tr><tr><td><pre>Returns: 142857144</pre></td></tr><tr><td><table><tr><td colspan="2"><p>The answer is 1/7.
Let's analyze one of possible scenarios.
Let's says that players have names Limak, A and B.</p>
<ul>
<li>Limak says 1.</li>
<li>A says 2, flips a coin and loses.
You can notice that Limak can't win this game anymore.</li>
<li>B says 1.</li>
<li>Limak says 2, flips a coin and survives.</li>
<li>B says 1.</li>
<li>Limak says 2, flips a coin and survives.</li>
<li>B says 1.</li>
<li>Limak says 2, flips a coin and loses. B wins.</li>
</ul></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">3)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>3</pre></td></tr><tr><td><pre>1</pre></td></tr></table></td></tr><tr><td><pre>Returns: 238095240</pre></td></tr><tr><td><table><tr><td colspan="2">The answer is 5/21.</td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">4)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>4</pre></td></tr><tr><td><pre>4</pre></td></tr></table></td></tr><tr><td><pre>Returns: 142857144</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">5)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>5</pre></td></tr><tr><td><pre>1000000000</pre></td></tr></table></td></tr><tr><td><pre>Returns: 142857144</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">6)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>2000</pre></td></tr><tr><td><pre>123</pre></td></tr></table></td></tr><tr><td><pre>Returns: 429232785</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr><tr><td align="center" nowrap="true">7)</td><td></td></tr><tr><td>&#160;&#160;&#160;&#160;</td><td><table><tr><td><table><tr><td><pre>1987</pre></td></tr><tr><td><pre>987654321</pre></td></tr></table></td></tr><tr><td><pre>Returns: 623410299</pre></td></tr><tr><td><table><tr><td colspan="2"></td></tr></table></td></tr></table></td></tr></table><p>This problem statement is the exclusive and proprietary property of TopCoder, Inc.  Any unauthorized use or reproduction of this information without the prior written consent of TopCoder, Inc. is strictly prohibited.  (c)2003, TopCoder, Inc.  All rights reserved.  </p></body></html>
